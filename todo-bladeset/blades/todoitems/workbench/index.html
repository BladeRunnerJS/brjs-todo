<!DOCTYPE html>
<html>
	<head>
		<title>Workbench</title>

		<!-- TODO: remove this workaround to ensure the eventhub is loaded as the aliases.xml is not being read -->
    <script>
      "br.event-hub";
    </script>
		
		<@css.bundle theme="standard"@/>
		<@js.bundle@/>
		<style>
		#main {
			margin-top: 50px;
		}
		</style>
		
		<script type="text/javascript">
			function initialize() {

				var TodoItemsViewModel = require( 'brjstodo/todo/todoitems/TodoItemsViewModel' );
				var KnockoutComponent = require( 'br/knockout/KnockoutComponent' );
				var PresentationModelViewer = require( 'br/presenter/workbench/ui/PresentationModelViewer' );

				var model = new TodoItemsViewModel();
				var component = new KnockoutComponent("brjstodo.todo.todoitems.view-template", model);

				// Workbench
				var PresentationModelViewer = require( 'br/presenter/workbench/ui/PresentationModelViewer' );
				var KnockoutModelTree = require( 'br/knockout/workbench/KnockoutModelTree' );
				var workbench = new br.workbench.ui.Workbench(250, 310);
				var presentationModelViewer = new PresentationModelViewer(model, KnockoutModelTree);
				workbench.addToRightWing(presentationModelViewer, "Visualise Presentation Model", false);

				// Display
				workbench.displayComponent(component, 200, 100);

				var ServiceRegistry = require( 'br/ServiceRegistry' );
				var eventHub = ServiceRegistry.getService( 'br.event-hub' );
				var fakeTodos = [
					{ title: 'Fake todo 1' },
					{ title: 'Fake todo 2' }
				];
				fakeTodos.forEach( function( todo ) {
					eventHub.channel( 'todo-list' ).trigger( 'todo-added', todo );
				} );
			}
		</script>
	</head>
	<body onload="initialize()">
	</body>
</html>